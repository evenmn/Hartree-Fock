import numpy as np

class Integrals:
    def __init__(self, Z, basis):
        '''Class returning matrix elements
        Arguments:
        ----------
        Z:      Int.
                Atomic number (proton number)
        basis:  Tuple.
                Connects state index to principal number and spin
        '''
        
        self.Z = Z
        self.basis = basis
        

    def OBME(self,p,q):
        '''One-Body Matrix Elements (OBME)'''
        
        n_p, s_p = self.basis[p]
        n_q, s_q = self.basis[q]
        
        if n_p==n_q and s_p==s_q:
            return -self.Z**2/(2*(n_p+1)**2)
        else:
            return 0


    def TBME(self,p,q,r,s):

        '''
        Hardcoded two-body matrix elements (TBME) <pq|V|rs> for project1 in FYS4480.
        '''
        
        Z = self.Z

        # Radial part
        u          = np.zeros((3,3,3,3))
        u[0,0,0,0] = (5*Z)/8.0
        u[0,0,0,1] = (4096*np.sqrt(2)*Z)/64827.0
        u[0,0,0,2] = (1269*np.sqrt(3)*Z)/50000.0
        u[0,0,1,0] = (4096*np.sqrt(2)*Z)/64827.0
        u[0,0,1,1] = (16*Z)/729.0
        u[0,0,1,2] = (110592*np.sqrt(6)*Z)/24137569.0
        u[0,0,2,0] = (1269*np.sqrt(3)*Z)/50000.0
        u[0,0,2,1] = (110592*np.sqrt(6)*Z)/24137569.0
        u[0,0,2,2] = (189*Z)/32768.0
        u[0,1,0,0] = (4096*np.sqrt(2)*Z)/64827.0
        u[0,1,0,1] = (17*Z)/81.0
        u[0,1,0,2] = (1555918848*np.sqrt(6)*Z)/75429903125.0
        u[0,1,1,0] = (16*Z)/729.0
        u[0,1,1,1] = (512*np.sqrt(2)*Z)/84375.0
        u[0,1,1,2] = (2160*np.sqrt(3)*Z)/823543.0
        u[0,1,2,0] = (110592*np.sqrt(6)*Z)/24137569.0
        u[0,1,2,1] = (29943*np.sqrt(3)*Z)/13176688.0
        u[0,1,2,2] = (1216512*np.sqrt(2)*Z)/815730721.0
        u[0,2,0,0] = (1269*np.sqrt(3)*Z)/50000.0
        u[0,2,0,1] = (1555918848*np.sqrt(6)*Z)/75429903125.0
        u[0,2,0,2] = (815*Z)/8192.0
        u[0,2,1,0] = (110592*np.sqrt(6)*Z)/24137569.0
        u[0,2,1,1] = (2160*np.sqrt(3)*Z)/823543.0
        u[0,2,1,2] = (37826560*np.sqrt(2)*Z)/22024729467.0
        u[0,2,2,0] = (189*Z)/32768.0
        u[0,2,2,1] = (1216512*np.sqrt(2)*Z)/815730721.0
        u[0,2,2,2] = (617*Z)/(314928.0*np.sqrt(3))
        u[1,0,0,0] = (4096*np.sqrt(2)*Z)/64827.0
        u[1,0,0,1] = (16*Z)/729.0
        u[1,0,0,2] = (110592*np.sqrt(6)*Z)/24137569.0
        u[1,0,1,0] = (17*Z)/81.0
        u[1,0,1,1] = (512*np.sqrt(2)*Z)/84375.0
        u[1,0,1,2] = (29943*np.sqrt(3)*Z)/13176688.0
        u[1,0,2,0] = (1555918848*np.sqrt(6)*Z)/75429903125.0
        u[1,0,2,1] = (2160*np.sqrt(3)*Z)/823543.0
        u[1,0,2,2] = (1216512*np.sqrt(2)*Z)/815730721.0
        u[1,1,0,0] = (16*Z)/729.0
        u[1,1,0,1] = (512*np.sqrt(2)*Z)/84375.0
        u[1,1,0,2] = (2160*np.sqrt(3)*Z)/823543.0
        u[1,1,1,0] = (512*np.sqrt(2)*Z)/84375.0
        u[1,1,1,1] = (77*Z)/512.0
        u[1,1,1,2] = (5870679552*np.sqrt(6)*Z)/669871503125.0
        u[1,1,2,0] = (2160*np.sqrt(3)*Z)/823543.0
        u[1,1,2,1] = (5870679552*np.sqrt(6)*Z)/669871503125.0
        u[1,1,2,2] = (73008*Z)/9765625.0
        u[1,2,0,0] = (110592*np.sqrt(6)*Z)/24137569.0
        u[1,2,0,1] = (2160*np.sqrt(3)*Z)/823543.0
        u[1,2,0,2] = (37826560*np.sqrt(2)*Z)/22024729467.0
        u[1,2,1,0] = (29943*np.sqrt(3)*Z)/13176688.0
        u[1,2,1,1] = (5870679552*np.sqrt(6)*Z)/669871503125.0
        u[1,2,1,2] = (32857*Z)/390625.0
        u[1,2,2,0] = (1216512*np.sqrt(2)*Z)/815730721.0
        u[1,2,2,1] = (73008*Z)/9765625.0
        u[1,2,2,2] = (6890942464*np.sqrt(2/3)*Z)/1210689028125.0
        u[2,0,0,0] = (1269*np.sqrt(3)*Z)/50000.0
        u[2,0,0,1] = (110592*np.sqrt(6)*Z)/24137569.0
        u[2,0,0,2] = (189*Z)/32768.0
        u[2,0,1,0] = (1555918848*np.sqrt(6)*Z)/75429903125.0
        u[2,0,1,1] = (2160*np.sqrt(3)*Z)/823543.0
        u[2,0,1,2] = (1216512*np.sqrt(2)*Z)/815730721.0
        u[2,0,2,0] = (815*Z)/8192.0
        u[2,0,2,1] = (37826560*np.sqrt(2)*Z)/22024729467.0
        u[2,0,2,2] = (617*Z)/(314928.0*np.sqrt(3))
        u[2,1,0,0] = (110592*np.sqrt(6)*Z)/24137569.0
        u[2,1,0,1] = (29943*np.sqrt(3)*Z)/13176688.0
        u[2,1,0,2] = (1216512*np.sqrt(2)*Z)/815730721.0
        u[2,1,1,0] = (2160*np.sqrt(3)*Z)/823543.0
        u[2,1,1,1] = (5870679552*np.sqrt(6)*Z)/669871503125.0
        u[2,1,1,2] = (73008*Z)/9765625.0
        u[2,1,2,0] = (37826560*np.sqrt(2)*Z)/22024729467.0
        u[2,1,2,1] = (32857*Z)/390625.0
        u[2,1,2,2] = (6890942464*np.sqrt(2/3)*Z)/1210689028125.0
        u[2,2,0,0] = (189*Z)/32768.0
        u[2,2,0,1] = (1216512*np.sqrt(2)*Z)/815730721.0
        u[2,2,0,2] = (617*Z)/(314928.0*np.sqrt(3))
        u[2,2,1,0] = (1216512*np.sqrt(2)*Z)/815730721.0
        u[2,2,1,1] = (73008*Z)/9765625.0
        u[2,2,1,2] = (6890942464*np.sqrt(2/3)*Z)/1210689028125.0
        u[2,2,2,0] = (617*Z)/(314928.0*np.sqrt(3))
        u[2,2,2,1] = (6890942464*np.sqrt(2/3)*Z)/1210689028125.0
        u[2,2,2,2] = (17*Z)/256.0
	    
        # Including spin part
        n_p, s_p = self.basis[p]
        n_q, s_q = self.basis[q]
        n_r, s_r = self.basis[r]
        n_s, s_s = self.basis[s]
        
        if s_p==s_r and s_q==s_s:
            return u[n_p,n_q,n_r,n_s]
        else:
            return 0
            

    def AS(self,p,q,r,s):
        '''Element is now antisymmetric, such that
        <pq|H|rs>AS=<pq|H|rs>-<pq|H|sr>'''
        
        return Integrals.TBME(self,p,q,r,s) - Integrals.TBME(self,p,q,s,r)
